{"version":3,"sources":["pages/message/index.js"],"names":["TextArea","Message","React","useState","messageContent","setMessageContent","text","setText","loveBgc","setloveBgc","updateData","callback","axios","get","then","res","data","reverse","console","log","err","useEffect","className","rows","onChange","e","target","value","type","onClick","post","qs","stringify","message","alert","LeaveMessage","block","map","item","index","id","twoToneColor","style","backgroundColor","love"],"mappings":"sSAMQA,E,IAAAA,SACO,SAASC,IAAW,IAAD,EACWC,IAAMC,SAAS,IAD1B,mBACvBC,EADuB,KACRC,EADQ,OAETH,IAAMC,SAAS,IAFN,mBAEvBG,EAFuB,KAElBC,EAFkB,OAGHL,IAAMC,SAAS,IAHZ,mBAGvBK,EAHuB,KAGfC,EAHe,KAIxBC,EAAW,SAACC,GACdC,IAAMC,IAAI,qCAAqCC,MAAK,SAAAC,GAChDV,EAAkBU,EAAIC,KAAKC,WAC3BC,QAAQC,IAAIJ,EAAIC,KAAKC,WACrBN,IACAO,QAAQC,IAAI,mBAEhB,SAAAC,GACIF,QAAQC,IAAI,gCAgDpB,OATAjB,IAAMmB,WAAU,WACZT,IAAMC,IAAI,qCAAqCC,MAAK,SAAAC,GAChDV,EAAkBU,EAAIC,KAAKC,cAE/B,SAAAG,GACIF,QAAQC,IAAI,6CAAUC,QAG5B,IAEE,sBAAKE,UAAU,UAAf,UACI,sBAAMA,UAAU,gBAAhB,UACF,cAACtB,EAAD,CAAUuB,KAAM,EAAIC,SA/CT,SAACC,GACdlB,EAAQkB,EAAEC,OAAOC,QA8C2BA,MAAOrB,IACjD,mBAAQsB,KAAK,UAAUC,QAAS,YA7CnB,SAACvB,GACN,KAAPA,EACCM,IAAMkB,KAAK,oCAAoCC,IAAGC,UAAU,CAACC,QAAQ3B,KAAQQ,MAAK,WAC9EoB,MAAM,4BACNxB,GAAW,WAAKH,EAAQ,UAE5B,SAAAa,GACIc,MAAM,+BAIVA,MAAM,wCAkC8BC,CAAa7B,IAAQgB,UAAU,aAAac,OAAK,EAAvF,yCAKA,uBACA,uBACA,6BAEIhC,EAAeiC,KAAI,SAACC,EAAKC,GACrB,OACA,6BACd,sBAAKjB,UAAU,kBAAf,UACAgB,EAAKL,QACN,sBAAKX,UAAU,eAAf,UAA8B,sBAAMO,QAAS,WA7C5B,IAACW,IA6C0CF,EAAKE,GA5C/C,KAAVhC,GACCC,EAAW,OACXG,IAAMC,IAAN,mDAAsD2B,EAAtD,sBAA4E,WACxE9B,OACF,SAAAU,GACEc,MAAM,iCAGVzB,EAAW,IACXG,IAAMC,IAAN,mDAAsD2B,EAAtD,sBAA4E,SAAAzB,GACxEL,OACF,SAAAU,GACEc,MAAM,6CAgCW,SAAyC,cAAC,IAAD,CAAcO,aAAa,UAAUC,MAAO,CAACC,gBAAgBnC,OAApI,IAAwJ8B,EAAKM,YAHrIL","file":"static/js/9.2255f1b9.chunk.js","sourcesContent":["import React from 'react'\r\nimport './index.css'\r\nimport { Input,Button } from 'antd';\r\nimport axios from 'axios'\r\nimport {HeartTwoTone} from '@ant-design/icons';\r\nimport qs from 'querystring'\r\nconst { TextArea } = Input;\r\nexport default function Message() {\r\n    const [messageContent,setMessageContent]=React.useState([])\r\n    const [text,setText]=React.useState('')\r\n    const [loveBgc,setloveBgc]=React.useState('')\r\n    const updateData=(callback)=>{\r\n        axios.get('http://aays.top:4000/board/search').then(res=>{\r\n            setMessageContent(res.data.reverse())\r\n            console.log(res.data.reverse());\r\n            callback()\r\n            console.log('查询');\r\n        },\r\n        err=>{\r\n            console.log('查询失败');\r\n        }\r\n        )\r\n    }\r\n    const textChange=(e)=>{\r\n        setText(e.target.value)\r\n    }\r\n    const LeaveMessage=(text)=>{\r\n        if(text!==''){\r\n            axios.post('http://aays.top:4000/board/insert',qs.stringify({message:text})).then(()=>{\r\n                alert('留言成功')\r\n                updateData(()=>{setText('')})\r\n            },\r\n            err=>{\r\n                alert('留言失败')\r\n            }\r\n            ) \r\n        }else{\r\n            alert('输入不能为空')\r\n        }\r\n    }\r\n    const Clicklove=(id)=>{\r\n        if(loveBgc===''){\r\n            setloveBgc('red')\r\n            axios.get(`http://aays.top:4000/board/updatelove?id=${id}&option=increment`,()=>{\r\n                updateData()\r\n            },err=>{\r\n                alert('点赞失败');\r\n            })\r\n        }else{\r\n            setloveBgc('')\r\n            axios.get(`http://aays.top:4000/board/updatelove?id=${id}&option=decrement`,res=>{\r\n                updateData()\r\n            },err=>{\r\n                alert('取消点赞失败')\r\n            })\r\n        }\r\n    }\r\n   \r\n    React.useEffect(()=>{\r\n        axios.get('http://aays.top:4000/board/search').then(res=>{\r\n            setMessageContent(res.data.reverse())\r\n        },\r\n        err=>{\r\n            console.log('请求数据库失败',err);\r\n        }\r\n        )\r\n    },[])\r\n    return (\r\n        <div className='message'>\r\n            <div  className='message-input'>\r\n          <TextArea rows={5}  onChange={textChange} value={text}/>\r\n          <Button type=\"primary\" onClick={( )=>{LeaveMessage(text)}} className='search-btn' block>\r\n      发表留言\r\n    </Button>\r\n          </div>\r\n    \r\n          <br />\r\n          <br />\r\n          <ul>\r\n          {\r\n              messageContent.map((item,index)=>{\r\n                  return (\r\n                  <li key={index}>\r\n    <div className='message-content'>\r\n   {item.message}\r\n   <div className='message-love'><span onClick={()=>{Clicklove(item.id)}}><HeartTwoTone twoToneColor=\"#eb2f96\" style={{backgroundColor:loveBgc}}/></span> {item.love}</div>\r\n</div>\r\n                  </li>\r\n                  )\r\n              })\r\n          }\r\n      </ul>\r\n        </div>\r\n    )\r\n}\r\n"],"sourceRoot":""}