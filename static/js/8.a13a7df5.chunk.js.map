{"version":3,"sources":["pages/user/login/index.js","pages/user/register/index.js","pages/user/index.js"],"names":["Login","props","React","useEffect","document","cookie","username","qs","parse","split","nameRef","current","value","useRef","passwordRef","className","ref","type","onClick","params","password","axios","post","stringify","then","res","alert","data","msg","state","PubSub","publish","date","Date","setTime","getTime","token","toGMTString","history","push","err","console","log","Register","rePasswordRef","User","path","component"],"mappings":"kSAKe,SAASA,EAAMC,GAC1BC,IAAMC,WAAU,WACZ,GAAqB,KAAlBC,SAASC,OAAY,CAAC,IACdC,EAAUC,IAAGC,MAAMJ,SAASC,OAAOI,MAAM,KAAK,IAA9CH,SACPI,EAAQC,QAAQC,MAAMN,KAE5B,IACF,IAAMI,EAAQR,IAAMW,SACdC,EAAYZ,IAAMW,SA4BxB,OACI,sBAAKE,UAAU,gBAAf,UACI,qBAAKA,UAAU,aAAf,0BACJ,sBAAKA,UAAU,aAAf,qCAAgC,uBAAOC,IAAKN,EAASO,KAAK,OAAOF,UAAU,kBACxE,sBAAKA,UAAU,iBAAf,+BAAmC,uBAAOC,IAAKF,EAAaG,KAAK,WAAWF,UAAU,kBACtF,sBAAKA,UAAU,WAAf,cAA2B,wBAAQG,QAhCxB,WACd,IAAMC,EAAO,CAACb,SAASI,EAAQC,QAAQC,MAAMQ,SAASN,EAAYH,QAAQC,OACrD,KAAlBO,EAAOb,SAIW,KAAlBa,EAAOC,SAIVC,IAAMC,KAAK,kCAAkCf,IAAGgB,UAAUJ,IAASK,MAAK,SAAAC,GAEpE,GADAC,MAAMD,EAAIE,KAAKC,KACK,YAAjBH,EAAIE,KAAKE,MAAkB,CAC1BC,IAAOC,QAAQ,YAAW,GAC1BD,IAAOC,QAAQ,WAAWN,EAAIE,KAAKrB,UACnC,IAAI0B,EAAK,IAAIC,KAEbD,EAAKE,QAAQF,EAAKG,UAAU,MAC5B/B,SAASC,OAAT,mBAA4Bc,EAAOb,SAAnC,kBAAqDmB,EAAIE,KAAKS,MAA9D,oBAA+EJ,EAAKK,eACpFpC,EAAMqC,QAAQC,KAAK,aAG3B,SAAAC,GACIC,QAAQC,IAAIF,MAhBfd,MAAM,wCAJHA,MAAM,+CA6BoB,gC,OC1CvB,SAASiB,EAAS1C,GAC7B,IAAMS,EAAQR,IAAMW,SACdC,EAAYZ,IAAMW,SAClB+B,EAAc1C,IAAMW,SA6B1B,OACI,sBAAKE,UAAU,gBAAf,UACI,qBAAKA,UAAU,aAAf,0BACJ,sBAAKA,UAAU,aAAf,qCAAgC,uBAAOC,IAAKN,EAASO,KAAK,OAAOF,UAAU,kBACxE,sBAAKA,UAAU,iBAAf,+BAAmC,uBAAOC,IAAKF,EAAaG,KAAK,WAAWF,UAAU,kBACtF,sBAAKA,UAAU,oBAAf,2CAAwC,uBAAOC,IAAK4B,EAAe3B,KAAK,WAAWF,UAAU,kBAC9F,sBAAKA,UAAU,WAAf,cAA2B,wBAAQG,QAlCrB,WAChB,IAAMC,EAAO,CAACb,SAASI,EAAQC,QAAQC,MAAMQ,SAASN,EAAYH,QAAQC,OACxEE,EAAYH,QAAQC,QAAQgC,EAAcjC,QAAQC,MAIhC,KAAlBO,EAAOb,SAIW,KAAlBa,EAAOC,SAITC,IAAMC,KAAK,qCAAqCf,IAAGgB,UAAUJ,IAASK,MAC9E,SAAAC,GACIf,EAAQC,QAAQC,MAAME,EAAYH,QAAQC,MAAMgC,EAAcjC,QAAQC,MAAM,GAC5Ec,MAAMD,EAAIE,MACI,6BAAXF,EAAIE,MACH1B,EAAMqC,QAAQC,KAAK,kBAG3B,SAAAC,GACId,MAAM,4BACNe,QAAQC,IAAI,2BAAOF,MAbfd,MAAM,wCAJHA,MAAM,8CAJjBA,MAAM,uEA+B+B,gC,OCpCtB,SAASmB,IACpB,OACI,sBAAK9B,UAAU,OAAf,UACR,cAAC,IAAD,CAAO+B,KAAK,cAAcC,UAAW/C,IACrC,cAAC,IAAD,CAAO8C,KAAK,iBAAiBC,UAAWJ,S","file":"static/js/8.a13a7df5.chunk.js","sourcesContent":["import React from 'react'\r\nimport './index.css'\r\nimport axios from 'axios'\r\nimport qs from 'querystring'\r\nimport PubSub from 'pubsub-js'\r\nexport default function Login(props) {\r\n    React.useEffect(()=>{\r\n        if(document.cookie!==''){\r\n            const {username}=qs.parse(document.cookie.split(';')[0])\r\n            nameRef.current.value=username\r\n        }\r\n    },[])\r\n    const nameRef=React.useRef()\r\n    const passwordRef=React.useRef()\r\n    let clickRegister=()=>{\r\n        const params={username:nameRef.current.value,password:passwordRef.current.value}\r\n        if(params.username===''){\r\n            alert('用户名不能为空')\r\n            return \r\n        }\r\n        if(params.password===''){\r\n         alert('密码不能为空')\r\n         return \r\n     }\r\n        axios.post('http://aays.top:4000/user/login',qs.stringify(params)).then(res=>{\r\n            alert(res.data.msg)\r\n            if(res.data.state==='success'){\r\n                PubSub.publish('HasLogin',true)\r\n                PubSub.publish('UserName',res.data.username)\r\n                let date=new Date()\r\n                // 获取时间戳并加上过期时间\r\n                date.setTime(date.getTime()+60000*60)\r\n                document.cookie=`username=${params.username}&token=${res.data.token};expires=${date.toGMTString()}`\r\n                props.history.push('/home')\r\n            }\r\n        },\r\n        err=>{\r\n            console.log(err);\r\n        }\r\n        )\r\n    }\r\n    return (\r\n        <div className='user-register'>\r\n            <div className='user-title'>登录</div>\r\n        <div className='name-input'>用户名：<input ref={nameRef} type='text' className='user-input'></input></div>\r\n           <div className='password-input'>密码：<input ref={passwordRef} type='password' className='user-input'></input></div>\r\n           <div className='user-btn'> <button onClick={clickRegister}>登录</button></div>\r\n        </div>\r\n    )\r\n}\r\n","import axios from 'axios'\r\nimport React from 'react'\r\nimport qs from 'querystring'\r\nimport './index.css'\r\nexport default function Register(props) {\r\n    const nameRef=React.useRef()\r\n    const passwordRef=React.useRef()\r\n    const rePasswordRef=React.useRef()\r\n    const clickRegister=()=>{\r\n        const params={username:nameRef.current.value,password:passwordRef.current.value}\r\n       if(passwordRef.current.value!==rePasswordRef.current.value){\r\nalert('两次输入的密码不一致！')\r\nreturn \r\n       }\r\n       if(params.username===''){\r\n           alert('用户名不能为空')\r\n           return \r\n       }\r\n       if(params.password===''){\r\n        alert('密码不能为空')\r\n        return \r\n    }\r\n        axios.post('http://aays.top:4000/user/register',qs.stringify(params)).then(\r\nres=>{\r\n    nameRef.current.value=passwordRef.current.value=rePasswordRef.current.value=''\r\n    alert(res.data)\r\n    if(res.data==='注册成功'){\r\n        props.history.push('/user/login')\r\n    }\r\n},\r\nerr=>{\r\n    alert('注册失败')\r\n    console.log('注册失败',err);\r\n}\r\n        )\r\n    }\r\n    return (\r\n        <div className='user-register'>\r\n            <div className='user-title'>注册</div>\r\n        <div className='name-input'>用户名：<input ref={nameRef} type='text' className='user-input'></input></div>\r\n           <div className='password-input'>密码：<input ref={passwordRef} type='password' className='user-input'></input></div>\r\n           <div className='re-Password-input'>重复密码：<input ref={rePasswordRef} type='password' className='user-input'></input></div>\r\n          <div className='user-btn'> <button onClick={clickRegister}>注册</button></div>\r\n        </div>\r\n    )\r\n}\r\n","import React from 'react'\r\nimport {Link,Route} from 'react-router-dom'\r\nimport Login from './login'\r\nimport Register from './register'\r\nimport {Menu} from 'antd'\r\nimport './index.css'\r\nexport default function User() {\r\n    return (\r\n        <div className='user'>\r\n<Route path='/user/login' component={Login}/>\r\n<Route path='/user/register' component={Register}/>\r\n        </div>\r\n    )\r\n}\r\n"],"sourceRoot":""}